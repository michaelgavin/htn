---
title: "Getting Started with `htn`"
author: "Travis Mullen and Michael Gavin"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Vignette Title}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---
##Introduction:
This tutorial will walk you through the basics of using the `htn` package.  The Historical Text Network package builds on the `tei2r` package's meta-data  management funcitonality.  `htn` uses the `docList` data to generate a social network for a given collection (typically, some subset of the EEBO-TCP). A typical use case would be to use `tei2r` to grab all the documents published in a given year, then to use `htn` to see how the authors, printers, and booksellers working in that year sorted into communities. 

The main purpose of historical text network analysis is to bridge the divide between text analysis and social network analysis. This package is designed to move in and out of different scales of analysis to compare and contrast lexical features of documents that appear in different communities.

We'll go from building a `docList` using `tei2r' to graphing the print network of a corpus, and it'll only take us a few commands.

The `tei2r` package includes several sample data sets.  We'll be using the `natlaw` corpus in this example.  This example will cover:

  1. Building a `docList` object using sample data.
  2. Graphing a corpus using `htn`'s `buildNetwork` function.
  3. Drawing the graph with and without coloring by communities.
  4. Drawing the graph of a specific community.

***
##Building a `docList` object using sample data
We'll start by building a `docList` object using the `buidDocList` function from `tei2r`.  In order to do this, we'll need to load the `tei2r` package and call the function with the sample data.

```{r}
library(tei2r)
data(natlaw)
setup(natlaw)
```

As you can see, these commands build a `docList` of publications having to do with seventeenth-century natural law. The `setup` command imports all the data, normalizes the texts, and preps them for analysis.

##Graphing our Corpus
Ok, we've loaded the `natlaw` data set and stored our `docList` in an object called `dl`.  Now we can generate a network object and graph with one command:

```{r}
library(htn)
dnet = buildNetwork(dl)
```

Now we've built our `docNetwork` object using the `natlaw` dataset.  `htn` has already built the graph, which is accessable through `dnet@graph` and detected the communities which are accessable through `dnet@communities`.

##Drawing the Graph
From here, it's easy to draw a graph using `htn`'s `drawGraph` function. By default, colors are assigned to the communities found when the network is built.
```{r, fig.width=8, fig.height=8}
drawGraph(dnet)
```

##Drawing the Graph of a Specific Community
I noticed that John Milton's community is fairly large and well connected and I would like to look more closely at it.  To do this, we'll need to figure out which community Milton belongs in. We can do that by running the command:
```r
viewCommunities(dnet)
```
Now we can graph Milton's community by using the same command as before and setting `sub=T` and `by=2`:
```{r, fig.height=8, fig.width=8, warning=F}
drawGraph(dnet@graph, comms=dnet@communities, sub=T, by=2)
```

##Summary
Now you can create a corpus and graph it in just a few steps using `tei2r` and `htn`!  Below you'll find a condensed version of what we've done above:
```{r, fig.height=8, fig.width=8, warning=F}
library(tei2r)
library(htn)
library(igraph)
dl = buildDocList(directory = system.file('extdata/natlaw/', package='tei2r'), indexFile=system.file('extdata/natlaw/index.csv', package='tei2r'))
dnet = buildNetwork(dl)
drawGraph(dnet@graph)
drawGraph(dnet@graph, comms=dnet@communities)
drawGraph(dnet@graph, comms=dnet@communities, sub=T, by=2)
```
